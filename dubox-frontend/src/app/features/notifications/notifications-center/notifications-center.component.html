<app-header></app-header>
<app-sidebar></app-sidebar>

<div class="page-container">
  <div class="page-content">
    <!-- Header -->
    <div class="notifications-header">
      <h1 class="page-title">
        <i class="bi bi-bell"></i>
        Notifications
      </h1>
      
      <!-- Filter Tabs -->
      <div class="filter-tabs">
        <button 
          class="filter-tab" 
          [class.active]="filter === 'all'" 
          (click)="setFilter('all')">
          All Notifications
        </button>
        <button 
          class="filter-tab" 
          [class.active]="filter === 'unread'" 
          (click)="setFilter('unread')">
          Unread
          <span class="unread-badge" *ngIf="(notificationService.unreadCount$ | async) as unreadCount">
            {{ unreadCount }}
          </span>
        </button>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="loading-container">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>

    <!-- Notifications List -->
    <div *ngIf="!loading" class="notifications-list">
      <!-- Empty State -->
      <div *ngIf="notifications.length === 0" class="empty-state">
        <i class="bi bi-bell-slash"></i>
        <h3>No Notifications</h3>
        <p>{{ filter === 'unread' ? 'You have no unread notifications' : 'You have no notifications yet' }}</p>
      </div>

      <!-- Notification Items -->
      <div 
        *ngFor="let notification of notifications" 
        class="notification-item" 
        [class.unread]="!notification.isRead"
        [ngClass]="getNotificationClass(notification.notificationType)"
        (click)="markAsRead(notification)">
        
        <!-- Icon -->
        <div class="notification-icon">
          <i class="bi" [ngClass]="getNotificationIcon(notification.notificationType)"></i>
        </div>

        <!-- Content -->
        <div class="notification-content">
          <div class="notification-header">
            <h4 class="notification-title">{{ notification.title }}</h4>
            <span class="notification-time">{{ formatTime(notification.createdDate) }}</span>
          </div>
          
          <p class="notification-message">{{ notification.message }}</p>
          
          <div class="notification-meta" *ngIf="notification.relatedIssueNumber || notification.commentAuthorName">
            <span *ngIf="notification.relatedIssueNumber" class="meta-tag">
              <i class="bi bi-tag"></i>
              Issue #{{ notification.relatedIssueNumber }}
            </span>
            <span *ngIf="notification.commentAuthorName" class="meta-tag">
              <i class="bi bi-person"></i>
              {{ notification.commentAuthorName }}
            </span>
          </div>
        </div>

        <!-- Unread Indicator -->
        <div class="unread-indicator" *ngIf="!notification.isRead"></div>
      </div>
    </div>

    <!-- Pagination -->
    <div class="pagination" *ngIf="!loading && totalPages > 1">
      <button 
        class="pagination-btn" 
        [disabled]="currentPage === 1" 
        (click)="previousPage()">
        <i class="bi bi-chevron-left"></i>
        Previous
      </button>
      
      <span class="pagination-info">
        Page {{ currentPage }} of {{ totalPages }} ({{ totalCount }} total)
      </span>
      
      <button 
        class="pagination-btn" 
        [disabled]="currentPage === totalPages" 
        (click)="nextPage()">
        Next
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </div>
</div>
