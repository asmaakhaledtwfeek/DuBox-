<div class="create-team-page">
  <app-header></app-header>
  <div class="page-container">
    <app-sidebar></app-sidebar>
    
    <main class="main-content">
      <!-- Breadcrumb Navigation -->
      <nav class="breadcrumb">
        <a routerLink="/teams" class="breadcrumb-link">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
          </svg>
          Crews
        </a>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="breadcrumb-separator">
          <polyline points="9 18 15 12 9 6"/>
        </svg>
        <span class="breadcrumb-current">Create New Crew</span>
      </nav>

      <!-- Page Header -->
      <div class="page-header">
        <div class="header-content">
          <div class="header-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
              <circle cx="9" cy="7" r="4"/>
              <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
            </svg>
          </div>
          <div>
            <h1 class="page-title">Create New Crew</h1>
            <p class="page-description">Add a new crew to manage your construction workforce</p>
          </div>
        </div>
      </div>

      <div class="form-container">
        <!-- Success Message -->
        <div *ngIf="successMessage" class="alert alert-success">
          <div class="alert-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
              <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
          </div>
          <div class="alert-content">
            <div class="alert-title">Success!</div>
            <div class="alert-message">{{ successMessage }}</div>
          </div>
        </div>

        <!-- Error Message -->
        <div *ngIf="error" class="alert alert-error">
          <div class="alert-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M12 8v4M12 16h.01"/>
            </svg>
          </div>
          <div class="alert-content">
            <div class="alert-title">Error</div>
            <div class="alert-message">{{ error }}</div>
          </div>
        </div>

        <form [formGroup]="teamForm" (ngSubmit)="onSubmit()">
          <!-- Form Section Header -->
          <div class="form-section-header">
            <h2 class="section-title">Crew Information</h2>
            <p class="section-description">Enter the basic details for the new crew</p>
          </div>

          <div class="form-grid">
            <!-- Crew Code -->
            <div class="form-group">
              <label for="teamCode" class="form-label">
                <span class="label-text">Crew Code <span class="required">*</span></span>
                <span class="label-hint">Unique identifier for the crew</span>
              </label>
              <div class="input-wrapper">
                <span class="input-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
                    <rect x="8" y="2" width="8" height="4" rx="1" ry="1"/>
                  </svg>
                </span>
                <input 
                  type="text" 
                  id="teamCode"
                  formControlName="teamCode"
                  class="form-control"
                  [class.invalid]="teamForm.get('teamCode')?.invalid && teamForm.get('teamCode')?.touched"
                  placeholder="e.g., ASM-A"
                  maxlength="50"
                />
              </div>
              <div class="form-feedback">
                <span *ngIf="teamForm.get('teamCode')?.invalid && teamForm.get('teamCode')?.touched" class="error-text">
                  <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="8" x2="12" y2="12"/>
                    <line x1="12" y1="16" x2="12.01" y2="16"/>
                  </svg>
                  Crew code is required
                </span>
                <span class="char-count">{{ teamForm.get('teamCode')?.value?.length || 0 }}/50</span>
              </div>
            </div>

            <!-- Crew Name -->
            <div class="form-group">
              <label for="teamName" class="form-label">
                <span class="label-text">Crew Name <span class="required">*</span></span>
                <span class="label-hint">Full name of the crew</span>
              </label>
              <div class="input-wrapper">
                <span class="input-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                    <circle cx="9" cy="7" r="4"/>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                  </svg>
                </span>
                <input 
                  type="text" 
                  id="teamName"
                  formControlName="teamName"
                  class="form-control"
                  [class.invalid]="teamForm.get('teamName')?.invalid && teamForm.get('teamName')?.touched"
                  placeholder="e.g., Assembly Crew A"
                  maxlength="200"
                />
              </div>
              <div class="form-feedback">
                <span *ngIf="teamForm.get('teamName')?.invalid && teamForm.get('teamName')?.touched" class="error-text">
                  <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="8" x2="12" y2="12"/>
                    <line x1="12" y1="16" x2="12.01" y2="16"/>
                  </svg>
                  Crew name is required
                </span>
                <span class="char-count">{{ teamForm.get('teamName')?.value?.length || 0 }}/200</span>
              </div>
            </div>

            <!-- Department -->
            <div class="form-group">
              <label for="departmentId" class="form-label">
                <span class="label-text">Department <span class="required">*</span></span>
                <span class="label-hint">Organizational unit</span>
              </label>
              <div class="input-wrapper">
                <span class="input-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                    <polyline points="9 22 9 12 15 12 15 22"/>
                  </svg>
                </span>
                <select 
                  id="departmentId"
                  formControlName="departmentId"
                  class="form-control"
                  [class.invalid]="teamForm.get('departmentId')?.invalid && teamForm.get('departmentId')?.touched"
                  [disabled]="loadingDepartments"
                >
                  <option value="">Select Department</option>
                  <option *ngFor="let dept of departments" [value]="dept.departmentId">{{ dept.departmentName }}</option>
                </select>
              </div>
              <div class="form-feedback">
                <span *ngIf="loadingDepartments" class="loading-text">
                  <svg class="spinner" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="2" x2="12" y2="6"/>
                    <line x1="12" y1="18" x2="12" y2="22"/>
                    <line x1="4.93" y1="4.93" x2="7.76" y2="7.76"/>
                    <line x1="16.24" y1="16.24" x2="19.07" y2="19.07"/>
                    <line x1="2" y1="12" x2="6" y2="12"/>
                    <line x1="18" y1="12" x2="22" y2="12"/>
                    <line x1="4.93" y1="19.07" x2="7.76" y2="16.24"/>
                    <line x1="16.24" y1="7.76" x2="19.07" y2="4.93"/>
                  </svg>
                  Loading departments...
                </span>
                <span *ngIf="teamForm.get('departmentId')?.invalid && teamForm.get('departmentId')?.touched" class="error-text">
                  <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="8" x2="12" y2="12"/>
                    <line x1="12" y1="16" x2="12.01" y2="16"/>
                  </svg>
                  Department is required
                </span>
              </div>
            </div>

            <!-- Trade -->
            <div class="form-group">
              <label for="trade" class="form-label">
                <span class="label-text">Trade</span>
                <span class="label-hint">Specialized trade (optional)</span>
              </label>
              <div class="input-wrapper">
                <span class="input-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
                  </svg>
                </span>
                <select 
                  id="trade"
                  formControlName="trade"
                  class="form-control"
                >
                  <option value="">Select Trade</option>
                  <option *ngFor="let trade of trades" [value]="trade">{{ trade }}</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Form Actions -->
          <div class="form-actions">
            <button type="button" class="btn btn-cancel" (click)="onCancel()" [disabled]="loading">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"/>
                <line x1="6" y1="6" x2="18" y2="18"/>
              </svg>
              Cancel
            </button>
            <button type="submit" class="btn btn-primary" [disabled]="loading || teamForm.invalid">
              <svg *ngIf="!loading" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                <polyline points="17 21 17 13 7 13 7 21"/>
                <polyline points="7 3 7 8 15 8"/>
              </svg>
              <svg *ngIf="loading" class="spinner-btn" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="2" x2="12" y2="6"/>
                <line x1="12" y1="18" x2="12" y2="22"/>
                <line x1="4.93" y1="4.93" x2="7.76" y2="7.76"/>
                <line x1="16.24" y1="16.24" x2="19.07" y2="19.07"/>
                <line x1="2" y1="12" x2="6" y2="12"/>
                <line x1="18" y1="12" x2="22" y2="12"/>
                <line x1="4.93" y1="19.07" x2="7.76" y2="16.24"/>
                <line x1="16.24" y1="7.76" x2="19.07" y2="4.93"/>
              </svg>
              <span *ngIf="loading">Creating Crew...</span>
              <span *ngIf="!loading">Create Crew</span>
            </button>
          </div>
        </form>
      </div>
    </main>
  </div>
</div>


