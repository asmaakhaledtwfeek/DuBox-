<app-header></app-header>
<app-sidebar></app-sidebar>

<div class="page-container">
  <div class="page-content">
    <!-- Loading State -->
    <div *ngIf="loading" class="loading-state">
      <div class="spinner"></div>
      <p>Loading team group details...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading && !teamGroup" class="error-state">
      <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <path d="M12 8v4M12 16h.01"/>
      </svg>
      <p>{{ error }}</p>
      <button class="btn btn-secondary" (click)="goBack()">Go Back</button>
    </div>

    <!-- Main Content -->
    <div *ngIf="teamGroup && !loading" class="edit-group-content">
      <!-- Page Header -->
      <div class="page-header">
        <button class="btn-back" (click)="goBack()">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="19" y1="12" x2="5" y2="12"/>
            <polyline points="12 19 5 12 12 5"/>
          </svg>
          Back to Group Details
        </button>

        <div class="title-section">
          <h1 class="page-title">Edit Team Group</h1>
          <p class="page-subtitle">
            Update information for <strong>{{ teamGroup.groupTag }}</strong>
          </p>
        </div>
      </div>

      <!-- Form Card -->
      <div class="form-card">
        <form [formGroup]="editGroupForm" (ngSubmit)="onSubmit()">
          <!-- Group Information Section -->
          <div class="form-section">
            <div class="section-header">
              <h2 class="section-title">Group Information</h2>
              <p class="section-description">Update the basic details of the team group</p>
            </div>

            <div class="form-grid">
              <!-- Team Info (Read-only) -->
              <div class="form-group readonly-field">
                <label class="form-label">Team</label>
                <div class="readonly-value">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                    <circle cx="9" cy="7" r="4"/>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                  </svg>
                  <span>{{ teamGroup.teamName }} ({{ teamGroup.teamCode }})</span>
                </div>
              </div>

              <!-- Group Tag -->
              <div class="form-group" [class.has-error]="isFieldInvalid('groupTag')">
                <label for="groupTag" class="form-label">
                  Group Tag <span class="required">*</span>
                </label>
                <input
                  type="text"
                  id="groupTag"
                  class="form-input"
                  formControlName="groupTag"
                  placeholder="e.g., G1, G2, A, B"
                  maxlength="50"
                />
                <div *ngIf="isFieldInvalid('groupTag')" class="error-message">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M12 8v4M12 16h.01"/>
                  </svg>
                  {{ getFieldError('groupTag') }}
                </div>
                <div class="field-hint">A unique identifier for this group within the team</div>
              </div>

              <!-- Group Type -->
              <div class="form-group" [class.has-error]="isFieldInvalid('groupType')">
                <label for="groupType" class="form-label">
                  Group Type <span class="required">*</span>
                </label>
                <input
                  type="text"
                  id="groupType"
                  class="form-input"
                  formControlName="groupType"
                  placeholder="e.g., Assembly, Installation, Quality Control"
                  maxlength="100"
                />
                <div *ngIf="isFieldInvalid('groupType')" class="error-message">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M12 8v4M12 16h.01"/>
                  </svg>
                  {{ getFieldError('groupType') }}
                </div>
                <div class="field-hint">The type or purpose of this group</div>
              </div>
            </div>
          </div>

          <!-- Status Section -->
          <div class="form-section">
            <div class="section-header">
              <h2 class="section-title">Group Status</h2>
              <p class="section-description">Manage the active status of the team group</p>
            </div>

            <div class="form-group-inline">
              <label class="toggle-container">
                <input
                  type="checkbox"
                  formControlName="isActive"
                  class="toggle-input"
                />
                <span class="toggle-slider"></span>
                <span class="toggle-label">
                  <strong>Active Status</strong>
                  <span class="toggle-hint">
                    {{ editGroupForm.get('isActive')?.value ? 'This group is currently active' : 'This group is currently inactive' }}
                  </span>
                </span>
              </label>
            </div>
          </div>

          <!-- Error/Success Messages -->
          <div *ngIf="error" class="alert alert-error">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M12 8v4M12 16h.01"/>
            </svg>
            {{ error }}
          </div>

          <div *ngIf="success" class="alert alert-success">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
              <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
            {{ success }}
          </div>

          <!-- Form Actions -->
          <div class="form-actions">
            <button
              type="button"
              class="btn btn-secondary"
              (click)="goBack()"
              [disabled]="submitting"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="btn btn-primary"
              [disabled]="submitting || editGroupForm.invalid"
            >
              <span *ngIf="!submitting">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                  <polyline points="17 21 17 13 7 13 7 21"/>
                  <polyline points="7 3 7 8 15 8"/>
                </svg>
                Save Changes
              </span>
              <span *ngIf="submitting" class="loading-text">
                <div class="spinner-small"></div>
                Saving...
              </span>
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

