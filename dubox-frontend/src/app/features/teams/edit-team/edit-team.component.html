<div class="edit-team-page">
  <app-header></app-header>
  <div class="page-container">
    <app-sidebar></app-sidebar>
    
    <main class="main-content">
      <div class="page-header">
        <h1 class="page-title">Edit Team</h1>
      </div>

      <div *ngIf="loading" class="loading-state">
        <div class="spinner"></div>
        <p>Loading team...</p>
      </div>

      <div *ngIf="!loading" class="form-container">
        <form [formGroup]="teamForm" (ngSubmit)="onSubmit()">
          <!-- Success Message -->
          <div *ngIf="successMessage" class="alert alert-success">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
              <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
            {{ successMessage }}
          </div>

          <!-- Error Message -->
          <div *ngIf="error" class="alert alert-error">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M12 8v4M12 16h.01"/>
            </svg>
            {{ error }}
          </div>

          <div class="form-grid">
            <!-- Team Code -->
            <div class="form-group">
              <label for="teamCode">Team Code <span class="required">*</span></label>
              <input 
                type="text" 
                id="teamCode"
                formControlName="teamCode"
                class="form-control"
                [class.invalid]="teamForm.get('teamCode')?.invalid && teamForm.get('teamCode')?.touched"
                placeholder="e.g., ASM-A"
              />
              <div *ngIf="teamForm.get('teamCode')?.invalid && teamForm.get('teamCode')?.touched" class="error-text">
                Team code is required
              </div>
            </div>

            <!-- Team Name -->
            <div class="form-group">
              <label for="teamName">Team Name <span class="required">*</span></label>
              <input 
                type="text" 
                id="teamName"
                formControlName="teamName"
                class="form-control"
                [class.invalid]="teamForm.get('teamName')?.invalid && teamForm.get('teamName')?.touched"
                placeholder="e.g., Assembly Team A"
              />
              <div *ngIf="teamForm.get('teamName')?.invalid && teamForm.get('teamName')?.touched" class="error-text">
                Team name is required
              </div>
            </div>

            <!-- Department -->
            <div class="form-group">
              <label for="departmentId">Department <span class="required">*</span></label>
              <select 
                id="departmentId"
                formControlName="departmentId"
                class="form-control"
                [class.invalid]="teamForm.get('departmentId')?.invalid && teamForm.get('departmentId')?.touched"
                [disabled]="loadingDepartments || teamHasMembers"
                [title]="teamHasMembers ? 'Cannot change department when team has members. Remove all members first.' : ''"
              >
                <option value="">Select Department</option>
                <option *ngFor="let dept of departments" [value]="dept.departmentId">{{ dept.departmentName }}</option>
              </select>
              <div *ngIf="loadingDepartments" class="loading-text">Loading departments...</div>
              <div *ngIf="teamHasMembers" class="info-text">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <path d="M12 16v-4M12 8h.01"/>
                </svg>
                Cannot change department when team has members. Remove all members first.
              </div>
              <div *ngIf="teamForm.get('departmentId')?.invalid && teamForm.get('departmentId')?.touched && !teamHasMembers" class="error-text">
                Department is required
              </div>
            </div>

            <!-- Trade -->
            <div class="form-group">
              <label for="trade">Trade</label>
              <select 
                id="trade"
                formControlName="trade"
                class="form-control"
              >
                <option value="">Select Trade</option>
                <option *ngFor="let trade of trades" [value]="trade">{{ trade }}</option>
              </select>
            </div>

            <!-- Is Active -->
            <div class="form-group full-width">
              <label class="checkbox-label">
                <input 
                  type="checkbox" 
                  formControlName="isActive"
                />
                <span>Active</span>
              </label>
            </div>
          </div>

          <!-- Form Actions -->
          <div class="form-actions">
            <button type="button" class="btn btn-secondary" (click)="onCancel()" [disabled]="saving">
              Cancel
            </button>
            <button type="submit" class="btn btn-primary" [disabled]="saving || teamForm.invalid">
              <span *ngIf="saving">Saving...</span>
              <span *ngIf="!saving">Save Changes</span>
            </button>
          </div>
        </form>
      </div>
    </main>
  </div>
</div>

