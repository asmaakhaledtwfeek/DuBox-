<app-header></app-header>
<app-sidebar></app-sidebar>

<div class="page-container">
  <div class="page-content">
    <!-- Loading State -->
    <div class="loading-container" *ngIf="loading">
      <div class="spinner"></div>
      <p>Loading crews...</p>
    </div>

    <!-- Error State -->
    <div class="error-container" *ngIf="error && !loading">
      <p class="error-message">{{ error }}</p>
      <button class="btn btn-primary" (click)="loadTeams()">Retry</button>
    </div>

    <!-- Dashboard Content -->
    <div *ngIf="!loading && !error">
      <!-- Dashboard Header -->
      <div class="dashboard-header">
        <div class="header-info">
          <h1 class="dashboard-title">Crews Dashboard</h1>
          <div class="dashboard-meta">
            <span class="meta-item">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75M13 7a4 4 0 1 1-8 0 4 4 0 0 1 8 0z"/>
              </svg>
              {{ stats.total }} Total Crews
            </span>
            <span class="meta-item">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 12l2 2 4-4M21 12c-1 0-3-1-3-3s2-3 3-3 3 1 3 3-2 3-3 3M3 12c1 0 3-1 3-3s-2-3-3-3-3 1-3 3 2 3 3 3"/>
              </svg>
              {{ stats.active }} Active
            </span>
          </div>
        </div>
        <div class="header-actions">
          <button 
            *ngIf="canCreate"
            class="btn btn-primary"
            (click)="createTeam()"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 5v14M5 12h14"/>
            </svg>
            Create Crew
          </button>
        </div>
      </div>

      <!-- KPI Cards -->
      <div class="kpi-grid">
        <div class="kpi-card clickable" 
             (click)="onCardClick('all')"
             [class.active-card]="selectedCardFilter === 'all'"
             title="Click to show all crews">
          <div class="kpi-icon" style="background: rgba(46, 125, 50, 0.1); color: var(--primary-color);">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75M13 7a4 4 0 1 1-8 0 4 4 0 0 1 8 0z"/>
            </svg>
          </div>
          <div class="kpi-content">
            <div class="kpi-value">{{ stats.total }}</div>
            <div class="kpi-label">Total Crews</div>
          </div>
        </div>

        <div class="kpi-card clickable" 
             (click)="onCardClick('active')"
             [class.active-card]="selectedCardFilter === 'active'"
             title="Click to show active crews only">
          <div class="kpi-icon" style="background: rgba(16, 185, 129, 0.1); color: var(--success-color);">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 12l2 2 4-4M21 12c-1 0-3-1-3-3s2-3 3-3 3 1 3 3-2 3-3 3M3 12c1 0 3-1 3-3s-2-3-3-3-3 1-3 3 2 3 3 3"/>
            </svg>
          </div>
          <div class="kpi-content">
            <div class="kpi-value">{{ stats.active }}</div>
            <div class="kpi-label">Active Crews</div>
          </div>
        </div>

       

        <div class="kpi-card clickable" 
             (click)="onCardClick('inactive')"
             [class.active-card]="selectedCardFilter === 'inactive'"
             title="Click to show inactive crews only">
          <div class="kpi-icon" style="background: rgba(239, 68, 68, 0.1); color: var(--error-color);">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0zM12 9v4M12 17h.01"/>
            </svg>
          </div>
          <div class="kpi-content">
            <div class="kpi-value">{{ stats.inactive }}</div>
            <div class="kpi-label">Inactive Crews</div>
          </div>
        </div>
        <div class="kpi-card clickable" 
        (click)="onCardClick('members')"
        [class.active-card]="selectedCardFilter === 'members'"
        title="Click to show all active crew members">
     <div class="kpi-icon" style="background: rgba(59, 130, 246, 0.1); color: var(--info-color);">
       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
         <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/>
       </svg>
     </div>
     <div class="kpi-content">
       <div class="kpi-value">{{ stats.totalMembers }}</div>
       <div class="kpi-label">Total Members</div>
     </div>
   </div>
      </div>

      <!-- Filters Section -->
      <div class="filters-card card">
        <div class="filters-content">
          <div class="search-box">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"/>
              <path d="m21 21-4.35-4.35"/>
            </svg>
            <input 
              type="text" 
              [formControl]="searchControl"
              [placeholder]="searchPlaceholder"
              class="search-input"
            />
          </div>

          <div class="filter-controls" *ngIf="currentView === 'crews'">
            <select 
              class="filter-select"
              [(ngModel)]="selectedDepartment"
              (change)="onDepartmentChange()"
              [ngModelOptions]="{standalone: true}"
            >
              <option value="All">All Departments</option>
              <option *ngFor="let dept of departments" [value]="dept">{{ dept }}</option>
            </select>

            <select 
              class="filter-select"
              [(ngModel)]="selectedTrade"
              (change)="onTradeChange()"
              [ngModelOptions]="{standalone: true}"
            >
              <option value="All">All Trades</option>
              <option *ngFor="let trade of trades" [value]="trade">{{ trade }}</option>
            </select>

            <label class="checkbox-label">
              <input 
                type="checkbox" 
                [(ngModel)]="showActiveOnly"
                (change)="onActiveToggle()"
                [ngModelOptions]="{standalone: true}"
              />
              <span>Show Active Only</span>
            </label>
          </div>
        </div>
      </div>

      <!-- Crews Table -->
      <div class="teams-table-card card" *ngIf="currentView === 'crews'">
        <h2 class="card-title">Crews List</h2>
        <div class="table-container">
          <table class="teams-table">
          <thead>
            <tr>
              <th>Code</th>
              <th>Name</th>
              <th>Department</th>
              <th>Trade</th>
              <th>Crew Leader</th>
              <th>Crew Size</th>
              <th>Status</th>
              <th>Created Date</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let team of paginatedTeams" [class.inactive]="!team.isActive">
              <td class="code-cell">
                <strong>{{ team.teamCode }}</strong>
              </td>
              <td class="name-cell">{{ team.teamName }}</td>
              <td>{{ team.departmentName || '-' }}</td>
              <td>{{ team.trade || '-' }}</td>
              <td>{{ team.teamLeaderName || '-' }}</td>
              <td class="size-cell">
                <span class="badge">{{ team.teamSize || 0 }}</span>
              </td>
              <td>
                <span class="status-badge" [class.active]="team.isActive" [class.inactive]="!team.isActive">
                  {{ team.isActive ? 'Active' : 'Inactive' }}
                </span>
              </td>
              <td>{{ team.createdDate | date:'short' }}</td>
              <td class="actions-cell">
                <button 
                  class="btn-icon btn-view-details"
                  (click)="viewDetails(team.teamId); $event.stopPropagation()"
                  title="View Details"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                    <circle cx="12" cy="12" r="3"/>
                  </svg>
                </button>
                <button 
                  class="btn-icon btn-view-activities"
                  (click)="viewTeamActivities(team); $event.stopPropagation()"
                  title="View Activities"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2M9 5a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2M9 5a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2"/>
                  </svg>
                </button>
                <button 
                  *ngIf="canEdit"
                  class="btn-icon btn-edit"
                  (click)="editTeam(team.teamId); $event.stopPropagation()"
                  title="Edit"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                  </svg>
                </button>
              </td>
            </tr>
          </tbody>
        </table>

          <!-- Mobile Card Layout -->
          <div class="mobile-teams-list">
            <div *ngFor="let team of paginatedTeams" class="mobile-team-card" [class.inactive]="!team.isActive">
              <div class="team-card-header">
                <div class="team-code-name">
                  <div class="team-code">{{ team.teamCode }}</div>
                  <div class="team-name">{{ team.teamName }}</div>
                </div>
                <span class="status-badge" [class.active]="team.isActive" [class.inactive]="!team.isActive">
                  {{ team.isActive ? 'Active' : 'Inactive' }}
                </span>
              </div>

              <div class="team-card-details">
                <div class="detail-item" *ngIf="team.departmentName">
                  <span class="detail-label">Department:</span>
                  <span class="detail-value">{{ team.departmentName }}</span>
                </div>
                <div class="detail-item" *ngIf="team.trade">
                  <span class="detail-label">Trade:</span>
                  <span class="detail-value">{{ team.trade }}</span>
                </div>
                <div class="detail-item" *ngIf="team.teamLeaderName">
                  <span class="detail-label">Crew Leader:</span>
                  <span class="detail-value">{{ team.teamLeaderName }}</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Crew Size:</span>
                  <span class="badge">{{ team.teamSize || 0 }}</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Created:</span>
                  <span class="detail-value">{{ team.createdDate | date:'short' }}</span>
                </div>
              </div>

              <div class="team-card-actions">
                <button 
                  class="btn-icon btn-view-details"
                  (click)="viewDetails(team.teamId)"
                  title="View Details"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                    <circle cx="12" cy="12" r="3"/>
                  </svg>
                </button>
                <button 
                  class="btn-icon btn-view-activities"
                  (click)="viewTeamActivities(team)"
                  title="View Activities"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2M9 5a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2M9 5a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2"/>
                  </svg>
                </button>
                <button 
                  *ngIf="canEdit"
                  class="btn-icon btn-edit"
                  (click)="editTeam(team.teamId)"
                  title="Edit"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                  </svg>
                </button>
              </div>
            </div>
          </div>

          <!-- Empty State -->
          <div *ngIf="paginatedTeams.length === 0 && !loading" class="empty-state">
            <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75M13 7a4 4 0 1 1-8 0 4 4 0 0 1 8 0z"/>
            </svg>
            <h3>No Crews Found</h3>
            <p>{{ teams.length === 0 ? 'Create your first crew to get started.' : 'No crews match your filters.' }}</p>
            <button 
              *ngIf="canCreate && teams.length === 0"
              class="btn btn-primary"
              (click)="createTeam()"
            >
              Create Crew
            </button>
          </div>
        </div>

        <!-- Pagination Section -->
        <div class="pagination-section" *ngIf="totalCount > 0">
          <div class="pagination-info">
            <span class="pagination-text">
              Showing <strong>{{ getStartIndex() }}</strong> - 
              <strong>{{ getEndIndex() }}</strong> of 
              <strong>{{ totalCount }}</strong> crews
            </span>
            <span class="page-info">
              (Page {{ currentPage }} of {{ totalPages }})
            </span>
          </div>
          
          <div class="pagination-controls-wrapper" *ngIf="totalPages > 1">
            <div class="pagination-controls">
              <button 
                class="btn-pagination btn-first" 
                (click)="onPageChange(1)" 
                [disabled]="currentPage === 1"
                title="First page">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="11 17 6 12 11 7"/>
                  <polyline points="18 17 13 12 18 7"/>
                </svg>
              </button>
              <button 
                class="btn-pagination btn-prev" 
                (click)="onPageChange(currentPage - 1)" 
                [disabled]="currentPage === 1"
                title="Previous page">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="15 18 9 12 15 6"/>
                </svg>
              </button>
              
              <div class="page-numbers">
                <button 
                  *ngFor="let page of getPageNumbers()" 
                  class="btn-page" 
                  [class.active]="page !== '...' && page === currentPage"
                  (click)="onPageChangePage(page)"
                  [disabled]="page === '...'">
                  {{ page }}
                </button>
              </div>

              <button 
                class="btn-pagination btn-next" 
                (click)="onPageChange(currentPage + 1)" 
                [disabled]="currentPage === totalPages"
                title="Next page">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="9 18 15 12 9 6"/>
                </svg>
              </button>
              <button 
                class="btn-pagination btn-last" 
                (click)="onPageChange(totalPages)" 
                [disabled]="currentPage === totalPages"
                title="Last page">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="13 17 18 12 13 7"/>
                  <polyline points="6 17 11 12 6 7"/>
                </svg>
              </button>
            </div>
          </div>

          <div class="page-size-selector">
            <label>Items per page:</label>
            <select [(ngModel)]="pageSize" (change)="onPageSizeChange()" [ngModelOptions]="{standalone: true}">
              <option [value]="10">10</option>
              <option [value]="25">25</option>
              <option [value]="50">50</option>
              <option [value]="100">100</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Members View -->
      <div class="teams-table-card card members-view-card" *ngIf="currentView === 'members'">
        <h2 class="card-title">All Active Crew Members</h2>
        
        <div class="members-view-content">
          <div class="loading-state" *ngIf="loadingAllMembers">
            <div class="spinner"></div>
            <p>Loading members...</p>
          </div>

          <div class="error-state" *ngIf="allMembersError && !loadingAllMembers">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" y1="8" x2="12" y2="12"/>
              <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
            <p class="error-message">{{ allMembersError }}</p>
          </div>

          <div *ngIf="!loadingAllMembers && !allMembersError">
            <div class="members-summary" *ngIf="filteredMembers.length > 0">
              <p class="summary-text">
                Showing <strong>{{ filteredMembers.length }}</strong> of <strong>{{ allActiveMembers.length }}</strong> Active Members
              </p>
            </div>

            <div class="members-grid" *ngIf="filteredMembers.length > 0">
              <div class="member-card" *ngFor="let member of filteredMembers">
                <div class="member-header">
                  <div class="member-avatar">
                    <span class="avatar-initials">{{ getUserInitials(member.employeeName || member.fullName || member.email) }}</span>
                  </div>
                  <div class="member-info">
                    <h3 class="member-name">{{ member.employeeName || member.fullName || member.email }}</h3>
                    <p class="member-team">{{ member.teamCode }} - {{ member.teamName }}</p>
                  </div>
                </div>
                <div class="member-details">
                  <div class="detail-row" *ngIf="member.email">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                      <polyline points="22,6 12,13 2,6"/>
                    </svg>
                    <span>{{ member.email }}</span>
                  </div>
                  <div class="detail-row" *ngIf="member.employeeCode">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                      <line x1="16" y1="2" x2="16" y2="6"/>
                      <line x1="8" y1="2" x2="8" y2="6"/>
                      <line x1="3" y1="10" x2="21" y2="10"/>
                    </svg>
                    <span>{{ member.employeeCode }}</span>
                  </div>
                  <div class="detail-row" *ngIf="member.mobileNumber">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                    </svg>
                    <span>{{ member.mobileNumber }}</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="empty-state" *ngIf="filteredMembers.length === 0">
              <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                <circle cx="9" cy="7" r="4"/>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
              </svg>
              <h3>No Members Found</h3>
              <p>{{ allActiveMembers.length === 0 ? 'No active members available.' : 'No members match your search criteria.' }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Crew Activities Modal -->
<div class="modal-overlay" *ngIf="showActivitiesModal" (click)="closeActivitiesModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Crew Activities - {{ selectedTeam?.teamName }}</h2>
      <button class="btn-close-modal" (click)="closeActivitiesModal()" title="Close">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>

    <div class="modal-body">
      <div class="loading-state" *ngIf="loadingActivities">
        <div class="spinner"></div>
        <p>Loading activities...</p>
      </div>

      <div *ngIf="!loadingActivities && teamActivities">
        <div class="activities-summary" *ngIf="teamActivities.activities.length > 0">
          <p class="summary-text">Total Activities: <strong>{{ teamActivities.totalCount }}</strong></p>
        </div>

        <div class="activities-table-wrapper" *ngIf="teamActivities.activities.length > 0">
          <table class="activities-table">
            <thead>
              <tr>
                <th>Activity Name</th>
                <th>Box Tag</th>
                <th>Project</th>
                <th>Status</th>
                <th>Progress</th>
                <th>Planned Start</th>
                <th>Planned End</th>
                <th>Actual Start</th>
                <th>Actual End</th>
                <th>Duration</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let activity of teamActivities.activities" class="activity-row" (click)="navigateToActivityDetails(activity)">
                <td class="activity-name">{{ activity.activityName }}</td>
                <td class="box-tag">{{ activity.boxTag }}</td>
                <td class="project-name">{{ activity.projectName }}</td>
                <td>
                  <span class="status-badge" [ngClass]="getStatusClass(activity.status)">
                    {{ getStatusLabel(activity.status) }}
                  </span>
                </td>
                <td class="progress-cell">
                  <div class="progress-bar-container">
                    <div class="progress-bar" [style.width.%]="activity.progressPercentage"></div>
                    <span class="progress-text">{{ formatProgress(activity.progressPercentage) }}</span>
                  </div>
                </td>
                <td class="date-cell">{{ formatDate(activity.plannedStartDate) }}</td>
                <td class="date-cell">{{ formatDate(activity.plannedEndDate) }}</td>
                <td class="date-cell">{{ formatDate(activity.actualStartDate) }}</td>
                <td class="date-cell">{{ formatDate(activity.actualEndDate) }}</td>
                <td class="duration-cell">{{ activity.duration ? activity.duration + ' days' : 'N/A' }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="empty-state" *ngIf="teamActivities.activities.length === 0">
          <p>No activities found for this crew.</p>
        </div>
      </div>
    </div>
  </div>
</div>

